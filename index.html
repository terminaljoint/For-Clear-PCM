<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>For Clear PCM – Structured JEE Platform</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0d1117;
  --panel:#161b22;
  --border:#30363d;
  --text:#e6edf3;
  --muted:#9aa4af;
  --accent:#2f81f7;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Inter,system-ui;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;font-size:13px}

header{padding:10px 14px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.brand{font-size:1.2rem;font-weight:800;line-height:1}
.tag{color:var(--muted);font-size:.7rem}

#editorBadge{background:#238636;color:#fff;padding:3px 8px;border-radius:999px;font-size:.6rem;font-weight:600;display:none}

.subject-bar{display:flex;gap:6px;padding:6px 10px;border-bottom:1px solid var(--border)}
.subject-btn{padding:4px 10px;border:1px solid var(--border);border-radius:8px;cursor:pointer;font-weight:600;background:var(--panel);font-size:.75rem}
.subject-btn.active{border-color:var(--accent);color:var(--accent)}

main{display:grid;grid-template-columns:200px 1fr;flex:1;min-height:0}

.sidebar{border-right:1px solid var(--border);padding:8px;overflow:auto}
.sidebar h3{font-size:.65rem;color:var(--muted);margin-bottom:6px;letter-spacing:.05em}
.node{padding:4px 6px;border-radius:6px;cursor:pointer;margin-bottom:1px;font-size:.75rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.node:hover{background:var(--panel)}
.node.active{background:var(--panel);border-left:2px solid var(--accent)}
.node.depth-1{padding-left:10px}
.node.depth-2{padding-left:18px}
.node.depth-3{padding-left:26px}
.node.depth-4{padding-left:34px}
.node.depth-5{padding-left:42px}

.content{padding:12px;overflow:auto}
.content h1{font-size:1rem;margin-bottom:4px}
.content .meta{color:var(--muted);font-size:.65rem;margin-bottom:8px}

textarea,select,button{width:100%;background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:6px;padding:6px;font-size:.75rem}
textarea{min-height:160px;line-height:1.4}
button.primary{background:var(--accent);border:none;font-weight:700}

#loginBox{max-width:260px;margin:30px auto;padding:14px;border:1px solid var(--border);border-radius:12px;background:var(--panel)}
#loginBox h2{text-align:center;margin-bottom:6px;font-size:.9rem}
#loginBox p{text-align:center;color:var(--muted);font-size:.7rem;margin-bottom:10px}

footer{border-top:1px solid var(--border);padding:6px;text-align:center;font-size:.6rem;color:var(--muted)}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig={apiKey:"AIzaSyAPzgwYDQQqR4y8aRcu8BmXfhYoLPXDuVM",authDomain:"forclearpcm.firebaseapp.com",projectId:"forclearpcm",storageBucket:"forclearpcm.firebasestorage.app",messagingSenderId:"313585574692",appId:"1:313585574692:web:d4e1262ce22c7cd0bb89b1"};
const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const provider=new GoogleAuthProvider();
const db=getFirestore(app);

const OWNER_UIDS=["NbJq7HLBt0Pd7O55f4u82HTWOyu2","4MXKQ1JnnIUARfdYlIUbD0Q4erD2"];

const syllabus = {
  Maths:{
    Sets_and_Relations:{
      Sets:{Definition:{Concept:{}},Representation:{Roster_Form:{},Set_Builder_Form:{}},Types:{Empty_Set:{},Singleton_Set:{},Finite_Set:{},Infinite_Set:{}},Subsets:{Proper_Subset:{},Improper_Subset:{},Power_Set:{Cardinality:{}},Operations:{Union:{},Intersection:{},Difference:{},Complement:{}},Laws:{De_Morgan_First:{},De_Morgan_Second:{}}},
      Relations:{Ordered_Pairs:{},Cartesian_Product:{},Types:{Reflexive:{},Symmetric:{},Transitive:{},Equivalence:{Equivalence_Classes:{}}},Functions:{Domain:{},Codomain:{},Range:{},Types:{One_One:{},Onto:{},Into:{},Bijective:{}}}}
    },
    Algebra:{
      Quadratic_Equations:{Standard_Form:{},Roots:{Nature_of_Roots:{},Discriminant:{}},Methods:{Factorisation:{},Completing_Square:{},Formula_Method:{}},Graphs:{Parabola:{Vertex:{},Axis:{},Intercepts:{}}}},
      Sequences_and_Series:{Arithmetic_Progression:{Nth_Term:{},Sum:{}},Geometric_Progression:{Nth_Term:{},Sum:{},Infinite_GP:{}},Harmonic_Progression:{Relation_with_AP:{}}},
      Permutations_and_Combinations:{Fundamental_Principle:{},Factorial:{},Arrangements:{},Combinations:{}},
      Binomial_Theorem:{Expansion:{},General_Term:{},Middle_Term:{},Properties:{}},
      Complex_Numbers:{Algebra_of_Complex:{},Argand_Plane:{},Modulus_Argument:{}},
      Matrices_and_Determinants:{Matrices:{Types:{},Operations:{}},Determinants:{Properties:{},Applications:{}}},
      Probability:{Classical_Probability:{},Conditional_Probability:{},Bayes_Theorem:{}}
    },
    Coordinate_Geometry:{
      Straight_Lines:{Slope:{},Equation_of_Line:{Point_Slope:{},Two_Point:{},Intercept_Form:{},Normal_Form:{}},Angle_Between_Lines:{},Distance_Formula:{}},
      Circles:{Equation:{Standard:{},General:{}},Tangent:{Length_of_Tangent:{},Condition_of_Tangent:{}},Chord:{Properties:{}}},
      Parabola:{Standard_Equation:{},Focus_Directrix:{},Latus_Rectum:{}},
      Ellipse:{Standard_Equation:{},Eccentricity:{},Director_Circle:{}},
      Hyperbola:{Standard_Equation:{},Asymptotes:{},Rectangular_Hyperbola:{}}
    },
    Calculus:{
      Limits:{Concept:{},Standard_Limits:{Trigonometric:{},Algebraic:{}},Continuity:{}},
      Differentiation:{Definition:{},Rules:{Product:{},Quotient:{},Chain:{}},Derivatives_of_Functions:{}},
      Applications_of_Derivatives:{Increasing_Decreasing:{},Maxima_Minima:{},Tangents_Normals:{}},
      Integration:{Indefinite:{Methods:{Substitution:{},Integration_by_Parts:{},Partial_Fractions:{}}},Definite:{Properties:{},Area_Under_Curve:{}}},
      Differential_Equations:{Order_Degree:{},Formation:{},Solution:{}}},
    Vectors_and_3D:{Vectors:{Addition:{},Scalar_Product:{},Vector_Product:{}},Three_D_Geometry:{Direction_Cosines:{},Equation_of_Line:{},Equation_of_Plane:{}}}
  },
  Physics:{
    Kinematics:{One_D_Motion:{Displacement:{},Velocity:{},Acceleration:{},Equations_of_Motion:{}},Two_D_Motion:{Projectile_Motion:{Range:{},Time_of_Flight:{},Maximum_Height:{}}}},
    Laws_of_Motion:{Newton_Laws:{First:{},Second:{},Third:{}},Friction:{Static:{},Kinetic:{}}},
    Work_Energy_Power:{Work:{},Energy:{Kinetic:{},Potential:{}},Power:{}},
    Rotational_Mechanics:{Torque:{},Angular_Momentum:{},Moment_of_Inertia:{}},
    Gravitation:{Newton_Law:{},Satellite_Motion:{},Escape_Velocity:{}},
    Oscillations_and_Waves:{SHM:{Time_Period:{}},Waves:{Wave_Equation:{},Sound_Waves:{}}},
    Thermodynamics:{Thermal_Properties:{},Laws_of_Thermodynamics:{First:{},Second:{}},Heat_Engines:{}},
    Electrostatics:{Electric_Charge:{},Coulomb_Law:{},Electric_Field:{},Electric_Potential:{}},
    Current_Electricity:{Ohms_Law:{},Resistance:{},Kirchhoffs_Laws:{}},
    Magnetism_and_Matter:{Magnetic_Field:{},Biot_Savart_Law:{},Ampere_Law:{}},
    Electromagnetic_Induction:{Faradays_Laws:{},Lenz_Law:{},Self_Inductance:{}},
    Alternating_Current:{AC_Circuits:{},Reactance:{},Power_Factor:{}},
    Optics:{Ray_Optics:{Reflection:{},Refraction:{}},Wave_Optics:{Interference:{},Diffraction:{}}},
    Modern_Physics:{Dual_Nature:{Photoelectric_Effect:{}},Atoms_and_Nuclei:{Radioactivity:{},Nuclear_Reactions:{}},Semiconductors:{Diode:{},Transistor:{}}}
  },
  Chemistry:{
    Physical:{Mole_Concept:{Laws:{},Stoichiometry:{}},Atomic_Structure:{Bohrs_Model:{}},Thermodynamics:{},Chemical_Kinetics:{},Electrochemistry:{},Solutions:{},Surface_Chemistry:{}},
    Inorganic:{Periodic_Table:{Trends:{}},Chemical_Bonding:{VSEPR:{},Hybridisation:{}},s_Block:{},p_Block:{},d_f_Block:{},Coordination_Compounds:{Nomenclature:{},Isomerism:{}}},
    Organic:{GOC:{Inductive_Effect:{},Resonance:{},Hyperconjugation:{}},Hydrocarbons:{Alkanes:{},Alkenes:{},Alkynes:{}},Haloalkanes_and_Haloarenes:{},Alcohols_Phenols_Ethers:{},Aldehydes_Ketones_Carboxylic_Acids:{},Amines:{},Biomolecules:{},Polymers:{},Chemistry_in_Everyday_Life:{}}
  }
};

let OWNER=false;
let path=[];

const content=document.getElementById('content');

async function loadNode(p){
  const ref=doc(db,'syllabus',p[0]);
  const snap=await getDoc(ref);
  return snap.exists()?snap.data().nodes?.[p.join('/')]||null:null;
}

async function saveNode(p,contentText,status){
  const ref=doc(db,'syllabus',p[0]);
  await setDoc(ref,{nodes:{[p.join('/')]:{content:contentText,status}}},{merge:true});
}

function renderSelector(){
  content.innerHTML='';

  // Breadcrumb (option 3)
  const bc=document.getElementById('breadcrumb');
  bc.innerHTML='';
  path.forEach((p,i)=>{
    const b=document.createElement('button');
    b.className='subject-btn';
    b.style.marginRight='4px';
    b.innerText=p;
    b.onclick=()=>{path=path.slice(0,i+1);renderSelector();};
    bc.appendChild(b);
  });

  let node=syllabus;
  for(const k of path) node=node[k];

  // Not terminal: buttons only
  if(typeof node==='object' && Object.keys(node).length>0){
    const title=document.createElement('h1');
    title.innerText=path.length?path[path.length-1]:'Select Subject';
    content.appendChild(title);

    Object.keys(node).forEach(k=>{
      const btn=document.createElement('button');
      btn.className='subject-btn';
      btn.innerText=k;
      btn.onclick=()=>{path.push(k);renderSelector();};
      content.appendChild(btn);
    });
    return;
  }

  // Terminal node
  renderEditor();
}

async function renderEditor(){
  const data = await loadNode(path) || {content:'',status:'empty'};
  content.innerHTML=`<h1>${path[path.length-1]}</h1><div class='meta'>Status: ${data.status}</div>`;

  if(OWNER){
    const sel=document.createElement('select');
    ['empty','draft','done','revised'].forEach(s=>{const o=document.createElement('option');o.value=o.text=s;if(s===data.status)o.selected=true;sel.appendChild(o);});
    const ta=document.createElement('textarea');ta.value=data.content;
    ta.oninput=()=>saveNode(path,ta.value,sel.value);
    sel.onchange=()=>saveNode(path,ta.value,sel.value);
    content.appendChild(sel);content.appendChild(ta);
  } else {
    content.innerHTML+= data.content?`<pre>${data.content}</pre>`:`<p class='meta'>No content yet</p>`;
  }
}

onAuthStateChanged(auth,user=>{
  OWNER=!!user&&OWNER_UIDS.includes(user.uid);
  document.getElementById('editorBadge').style.display=OWNER?'inline-block':'none';
  document.getElementById('loginBox').style.display=user?'none':'block';
  document.getElementById('logoutBtn').style.display=user?'block':'none';
  renderSelector();
});

renderSelector();
</script>
</head>
<body>
<header>
  <div>
    <div class="brand">For Clear PCM</div>
    <div class="tag">Structured JEE Learning · Firebase Powered</div>
  </div>
  <div id="editorBadge">EDITOR MODE</div>
</header>

<div class="subject-bar">
  <div class="subject-btn" data-sub="Maths">Maths</div>
  <div class="subject-btn" data-sub="Physics">Physics</div>
  <div class="subject-btn" data-sub="Chemistry">Chemistry</div>
</div>

<main>
  <section class="content" id="content">
  <div id="breadcrumb" style="margin-bottom:6px"></div>
</section>
</main>

<div id="loginBox">
  <h2>Owner Access</h2>
  <p>Only verified editors can modify content.</p>
  <button id="loginBtn" class="primary">Sign in with Google</button>
</div>

<button id="logoutBtn" style="display:none;margin:12px">Logout</button>

<footer>©2026 Terminal Joint · For Clear PCM</footer>
</body>
</html>
