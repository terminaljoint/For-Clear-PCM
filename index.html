<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>For Clear PCM – Structured JEE Platform</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0d1117;
  --panel:#161b22;
  --border:#30363d;
  --text:#e6edf3;
  --muted:#9aa4af;
  --accent:#2f81f7;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Inter,system-ui;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;font-size:14px}

header{padding:14px 18px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.brand{font-size:1.4rem;font-weight:800;line-height:1}
.tag{color:var(--muted);font-size:.75rem}

#editorBadge{background:#238636;color:#fff;padding:4px 10px;border-radius:999px;font-size:.65rem;font-weight:600;display:none}

.subject-bar{display:flex;gap:8px;padding:8px 12px;border-bottom:1px solid var(--border)}
.subject-btn{padding:6px 12px;border:1px solid var(--border);border-radius:10px;cursor:pointer;font-weight:600;background:var(--panel);font-size:.8rem}
.subject-btn.active{border-color:var(--accent);color:var(--accent)}

main{display:grid;grid-template-columns:220px 1fr;flex:1;min-height:0}

.sidebar{border-right:1px solid var(--border);padding:12px;overflow:auto}
.sidebar h3{font-size:.7rem;color:var(--muted);margin-bottom:6px;letter-spacing:.05em}
.node{padding:6px 8px;border-radius:6px;cursor:pointer;margin-bottom:2px;font-size:.8rem}
.node:hover{background:var(--panel)}
.node.active{background:var(--panel);border-left:2px solid var(--accent)}

.content{padding:18px;overflow:auto}
.content h1{font-size:1.2rem;margin-bottom:4px}
.content .meta{color:var(--muted);font-size:.7rem;margin-bottom:12px}

textarea,select,button{width:100%;background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:8px;font-size:.8rem}
textarea{min-height:200px;line-height:1.5}
button.primary{background:var(--accent);border:none;font-weight:700}

#loginBox{max-width:300px;margin:40px auto;padding:18px;border:1px solid var(--border);border-radius:14px;background:var(--panel)}
#loginBox h2{text-align:center;margin-bottom:8px;font-size:1rem}
#loginBox p{text-align:center;color:var(--muted);font-size:.75rem;margin-bottom:14px}

footer{border-top:1px solid var(--border);padding:8px;text-align:center;font-size:.65rem;color:var(--muted)}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig={apiKey:"AIzaSyAPzgwYDQQqR4y8aRcu8BmXfhYoLPXDuVM",authDomain:"forclearpcm.firebaseapp.com",projectId:"forclearpcm",storageBucket:"forclearpcm.firebasestorage.app",messagingSenderId:"313585574692",appId:"1:313585574692:web:d4e1262ce22c7cd0bb89b1"};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const provider=new GoogleAuthProvider();
const db=getFirestore(app);

const OWNER_UIDS=["NbJq7HLBt0Pd7O55f4u82HTWOyu2","4MXKQ1JnnIUARfdYlIUbD0Q4erD2"];

const syllabus={
Maths:{Sets_and_Relations:{Sets:{Definition:{Meaning:{},Representation:{Roster:{},SetBuilder:{}}},Types:{Empty:{},Singleton:{},Finite:{},Infinite:{}},Subsets:{Proper:{},Improper:{},PowerSet:{Cardinality:{Formula:{}}}},Operations:{Union:{},Intersection:{},Difference:{},Complement:{}},Laws:{DeMorgan:{First:{},Second:{}}}},Relations:{OrderedPairs:{CartesianProduct:{}},Types:{Reflexive:{},Symmetric:{},Transitive:{},Equivalence:{Classes:{}}},Functions:{Domain:{},Codomain:{},Range:{},Types:{OneOne:{},Onto:{},Into:{},Bijective:{}}}}},Algebra:{Quadratic_Equations:{Standard_Form:{},Roots:{Nature:{Discriminant:{Positive:{},Zero:{},Negative:{}}}},Methods:{Factorisation:{},Completing_Square:{},Formula:{}},Graph:{Parabola:{Vertex:{},Axis:{},Intercepts:{}}}},Sequences_and_Series:{AP:{Terms:{},Sum:{},Properties:{}},GP:{Terms:{},Sum:{},Infinite_GP:{}},HP:{Relation_With_AP:{}}}},Coordinate_Geometry:{Straight_Lines:{Slope:{Definition:{},Formula:{}},Forms:{Point_Slope:{},Two_Point:{},Intercept:{},Normal:{}},Distance:{Between_Points:{},Point_to_Line:{}},Angle:{Between_Lines:{}}},Circles:{Equation:{Standard:{},General:{}},Tangent:{Length:{},Condition:{}},Chord:{Properties:{}}}},Calculus:{Limits:{Concept:{Approach:{}},Standard_Limits:{Trigonometric:{},Algebraic:{}},Techniques:{Rationalisation:{},LHopital:{}}},Differentiation:{Definition:{},Rules:{Product:{},Quotient:{},Chain:{}},Applications:{Slope:{},Maxima_Minima:{}}},Integration:{Indefinite:{Methods:{Substitution:{},Parts:{},Partial_Fractions:{}}},Definite:{Properties:{},Area_Under_Curve:{}}}}},Physics:{Kinematics:{One_D:{Quantities:{Displacement:{},Velocity:{},Acceleration:{}},Equations:{First:{},Second:{},Third:{}},Graphs:{x_t:{},v_t:{},a_t:{}}},Two_D:{Projectile:{Range:{},Time_of_Flight:{},Max_Height:{}},Relative_Motion:{}}},Laws_of_Motion:{Newton_Laws:{First:{},Second:{},Third:{}},Friction:{Static:{},Kinetic:{},Limiting:{}},Applications:{Lift:{},Pulley:{}}},Work_Energy_Power:{Work:{Variable_Force:{}},Energy:{Kinetic:{},Potential:{}},Theorems:{Work_Energy:{},Conservation:{}},Power:{}},Electrodynamics:{Electrostatics:{Charge:{Properties:{}},Coulomb_Law:{},Electric_Field:{},Electric_Potential:{}},Current_Electricity:{Ohm_Law:{},Circuits:{Series:{},Parallel:{}},Kirchhoff:{Rules:{}}}}},Chemistry:{Physical:{Mole_Concept:{Laws:{Conservation_of_Mass:{},Definite_Proportions:{}},Calculations:{Stoichiometry:{},Limiting_Reagent:{}},Concentration:{Molarity:{},Molality:{},Normality:{}}},Thermodynamics:{System:{},Surroundings:{},Laws:{First:{},Second:{}},Functions:{Enthalpy:{},Entropy:{},Gibbs_Free_Energy:{}}}},Organic:{GOC:{Bonding:{Sigma:{},Pi:{}},Effects:{Inductive:{},Resonance:{},Hyperconjugation:{}},Acidity_Basicity:{}},Hydrocarbons:{Alkanes:{Properties:{},Reactions:{}},Alkenes:{Mechanism:{},Reactions:{}},Alkynes:{Reactions:{}}}},Inorganic:{Periodic_Table:{Trends:{Atomic_Radius:{},Ionisation_Energy:{},Electronegativity:{}},Blocks:{s_Block:{},p_Block:{},d_Block:{},f_Block:{}}},Coordination_Compounds:{Nomenclature:{},Isomerism:{Structural:{},Geometrical:{},Optical:{}},Bonding:{VBT:{},CFT:{}}}}}};

let OWNER=false;
const isLeaf=node=>typeof node==='object'&&Object.keys(node).length===0;
let currentSubject=null;
let currentPath=[];

window.addEventListener('DOMContentLoaded',()=>{
  const sidebar=document.getElementById('sidebar');
  const content=document.getElementById('content');
  const badge=document.getElementById('editorBadge');

  function renderSidebar(node,path=[]){
    sidebar.innerHTML='<h3>SYLLABUS</h3>';
    Object.keys(node).forEach(k=>{
      const d=document.createElement('div');
      d.className='node'+(path.join('/')===currentPath.join('/')?' active':'');
      d.innerText=k;
      d.onclick=()=>{currentPath=[...path,k];render();};
      sidebar.appendChild(d);
    });
  }

  async function loadNode(path){
    const ref=doc(db,'syllabus',path[0]);
    const snap=await getDoc(ref);
    return snap.exists()?snap.data().nodes?.[path.join('/')]||null:null;
  }

  async function saveNode(path,content,status){
    const ref=doc(db,'syllabus',path[0]);
    await setDoc(ref,{nodes:{[path.join('/')]:{content,status}}},{merge:true});
  }

  async function render(){
    if(!currentSubject){
      sidebar.innerHTML='<h3>START</h3><div class="node">Select a subject</div>';
      content.innerHTML='<h1>For Clear PCM</h1><p class="meta">A structured, owner-controlled JEE learning platform.</p>';
      return;
    }

    let node=syllabus[currentSubject];
    for(let i=1;i<currentPath.length;i++) node=node[currentPath[i]];

    renderSidebar(node,currentPath);

    if(!isLeaf(node)){
      content.innerHTML='<h1>'+currentPath[currentPath.length-1]+'</h1><p class="meta">Navigate deeper</p>';
      return;
    }

    const data=await loadNode(currentPath)||{content:'',status:'empty'};
    content.innerHTML=`<h1>${currentPath[currentPath.length-1]}</h1><div class='meta'>Status: ${data.status}</div>`;

    if(OWNER){
      const sel=document.createElement('select');
      ['empty','draft','done','revised'].forEach(s=>{const o=document.createElement('option');o.value=o.text=s;if(s===data.status)o.selected=true;sel.appendChild(o);});
      const ta=document.createElement('textarea');ta.value=data.content;
      ta.oninput=()=>saveNode(currentPath,ta.value,sel.value);
      sel.onchange=()=>saveNode(currentPath,ta.value,sel.value);
      content.appendChild(sel);content.appendChild(ta);
    } else {
      content.innerHTML+= data.content?`<pre>${data.content}</pre>`:`<p class='meta'>No content yet</p>`;
    }
  }

  document.querySelectorAll('.subject-btn').forEach(b=>b.onclick=()=>{currentSubject=b.dataset.sub;currentPath=[b.dataset.sub];render();});
  document.getElementById('loginBtn').onclick=()=>signInWithPopup(auth,provider);
  document.getElementById('logoutBtn').onclick=()=>signOut(auth);

  onAuthStateChanged(auth,user=>{
    OWNER=!!user&&OWNER_UIDS.includes(user.uid);
    badge.style.display=OWNER?'inline-block':'none';
    document.getElementById('loginBox').style.display=user?'none':'block';
    document.getElementById('logoutBtn').style.display=user?'block':'none';
    render();
  });

  render();
});
</script>
</head>
<body>
<header>
  <div>
    <div class="brand">For Clear PCM</div>
    <div class="tag">Structured JEE Learning · Firebase Powered</div>
  </div>
  <div id="editorBadge">EDITOR MODE</div>
</header>

<div class="subject-bar">
  <div class="subject-btn" data-sub="Maths">Maths</div>
  <div class="subject-btn" data-sub="Physics">Physics</div>
  <div class="subject-btn" data-sub="Chemistry">Chemistry</div>
</div>

<main>
  <aside class="sidebar" id="sidebar"></aside>
  <section class="content" id="content"></section>
</main>

<div id="loginBox">
  <h2>Owner Access</h2>
  <p>Only verified editors can modify content.</p>
  <button id="loginBtn" class="primary">Sign in with Google</button>
</div>

<button id="logoutBtn" style="display:none;margin:20px">Logout</button>

<footer>©2026 Terminal Joint · For Clear PCM</footer>
</body>
</html>
